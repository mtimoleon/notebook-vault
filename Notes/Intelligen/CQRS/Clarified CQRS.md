Clipped from: [https://udidahan.com/2009/12/09/clarified-cqrs/](https://udidahan.com/2009/12/09/clarified-cqrs/)  
    

Wednesday, December 9th, 2009.

![clarification](Exported%20image%2020260209135103-0.png)
 After listening how the community has interpreted Command-Query Responsibility Segregation I think that the time has come for some clarification. Some have been tying it together to Event Sourcing. Most have been overlaying their previous layered architecture assumptions on it. Here I hope to identify CQRS itself, and describe in which places it can connect to other patterns.  
[Download as PDF](https://udidahan.com/wp-content/uploads/Clarified_CQRS.pdf) – this is quite a long post.

### Why CQRS

Before describing the details of CQRS we need to understand the two main driving forces behind it: collaboration and staleness.  
Collaboration refers to circumstances under which multiple actors will be using/modifying the same set of data – whether or not the intention of the actors is actually to collaborate with each other. There are often rules which indicate which user can perform which kind of modification and modifications that may have been acceptable in one case may not be acceptable in others. We’ll give some examples shortly. Actors can be human like normal users, or automated like software.  
Staleness refers to the fact that in a collaborative environment, once data has been shown to a user, that same data may have been changed by another actor – it is stale. Almost any system which makes use of a cache is serving stale data – often for performance reasons. What this means is that we cannot entirely trust our users decisions, as they could have been made based on out-of-date information.  
Standard layered architectures don’t explicitly deal with either of these issues. While putting everything in the same database may be one step in the direction of handling collaboration, staleness is usually exacerbated in those architectures by the use of caches as a performance-improving afterthought.

### A picture for reference

I’ve given some talks about CQRS using this diagram to explain it:

![CQRS](Exported%20image%2020260209135106-1.png)

The boxes named AC are Autonomous Components. We’ll describe what makes them autonomous when discussing commands. But before we go into the complicated parts, let’s start with queries:

### Queries

If the data we’re going to be showing users is stale anyway, is it really necessary to go to the master database and get it from there? Why transform those 3rd normal form structures to domain objects if we just want data – not any rule-preserving behaviors? Why transform those domain objects to DTOs to transfer them across a wire, and who said that wire has to be exactly there? Why transform those DTOs to view model objects?  
In short, it looks like we’re doing a heck of a lot of unnecessary work based on the assumption that reusing code that has already been written will be easier than just solving the problem at hand. Let’s try a different approach:  
How about we create an additional data store whose data can be a bit out of sync with the master database – I mean, the data we’re showing the user is stale anyway, so why not reflect in the data store itself. We’ll come up with an approach later to keep this data store more or less in sync.  
Now, what would be the correct structure for this data store? How about just like the view model? One table for each view. Then our client could simply SELECT * FROM MyViewTable (or possibly pass in an ID in a where clause), and bind the result to the screen. That would be just as simple as can be. You could wrap that up with a thin facade if you feel the need, or with stored procedures, or using [AutoMapper](http://automapper.codeplex.com/) which can simply map from a data reader to your view model class. The thing is that the view model structures are already wire-friendly, so you don’t need to transform them to anything else.  
You could even consider taking that data store and putting it in your web tier. It’s just as secure as an in-memory cache in your web tier. Give your web servers SELECT only permissions on those tables and you should be fine.

### Query Data Storage

While you can use a regular database as your query data store it isn’t the only option. Consider that the query schema is in essence identical to your view model. You don’t have any relationships between your various view model classes, so you shouldn’t need any relationships between the tables in the query data store.  
So do you actually need a _relational_ database?  
The answer is no, but for all practical purposes and due to organizational inertia, it is probably your best choice (for now).

### Scaling Queries

Since your queries are now being performed off of a separate data store than your master database, and there is no assumption that the data that’s being served is 100% up to date, you can easily add more instances of these stores without worrying that they don’t contain the exact same data. The same mechanism that updates one instance can be used for many instances, as we’ll see later.  
This gives you cheap horizontal scaling for your queries. Also, since your not doing nearly as much transformation, the latency per query goes down as well. Simple code is fast code.

### Data modifications

Since our users are making decisions based on stale data, we need to be more discerning about which things we let through. Here’s a scenario explaining why:  
Let’s say we have a customer service representative who is one the phone with a customer. This user is looking at the customer’s details on the screen and wants to make them a ‘preferred’ customer, as well as modifying their address, changing their title from Ms to Mrs, changing their last name, and indicating that they’re now married. What the user doesn’t know is that after opening the screen, an event arrived from the billing department indicating that this same customer doesn’t pay their bills – they’re delinquent. At this point, our user submits their changes.  
Should we accept their changes?  
Well, we should accept some of them, but not the change to ‘preferred’, since the customer is delinquent. But writing those kinds of checks is a pain – we need to do a diff on the data, infer what the changes mean, which ones are related to each other (name change, title change) and which are separate, identify which data to check against – not just compared to the data the user retrieved, but compared to the current state in the database, and then reject or accept.  
Unfortunately for our users, we tend to reject the whole thing if any part of it is off. At that point, our users have to refresh their screen to get the up-to-date data, and retype in all the previous changes, hoping that this time we won’t yell at them because of an optimistic concurrency conflict.  
As we get larger entities with more fields on them, we also get more actors working with those same entities, and the higher the likelihood that something will touch some attribute of them at any given time, increasing the number of concurrency conflicts.  
If only there was some way for our users to provide us with the right level of granularity and intent when modifying data. That’s what commands are all about.

### Commands

A core element of CQRS is rethinking the design of the user interface to enable us to capture our users’ intent such that making a customer preferred is a different unit of work for the user than indicating that the customer has moved or that they’ve gotten married. Using an Excel-like UI for data changes doesn’t capture intent, as we saw above.  
We could even consider allowing our users to submit a new command even before they’ve received confirmation on the previous one. We could have a little widget on the side showing the user their pending commands, checking them off asynchronously as we receive confirmation from the server, or marking them with an X if they fail. The user could then double-click that failed task to find information about what happened.  
Note that the client _sends_ commands to the server – it doesn’t publish them. Publishing is reserved for events which state a fact – that something has happened, and that the publisher has no concern about what receivers of that event do with it.

### Commands and Validation

In thinking through what could make a command fail, one topic that comes up is validation. Validation is different from business rules in that it states a context-independent fact about a command. Either a command is valid, or it isn’t. Business rules on the other hand are context dependent.  
In the example we saw before, the data our customer service rep submitted was valid, it was only due to the billing event arriving earlier which required the command to be rejected. Had that billing event not arrived, the data would have been accepted.  
Even though a command may be valid, there still may be reasons to reject it.  
As such, validation can be performed on the client, checking that all fields required for that command are there, number and date ranges are OK, that kind of thing. The server would still validate all commands that arrive, not trusting clients to do the validation.

### Rethinking UIs and commands in light of validation

The client can make of the query data store when validating commands. For example, before submitting a command that the customer has moved, we can check that the street name exists in the query data store.  
At that point, we may rethink the UI and have an auto-completing text box for the street name, thus ensuring that the street name we’ll pass in the command will be valid. But why not take things a step further? Why not pass in the street ID instead of its name? Have the command represent the street not as a string, but as an ID (int, guid, whatever).  
On the server side, the only reason that such a command would fail would be due to concurrency – that someone had deleted that street and that that hadn’t been reflected in the query store yet; a fairly exceptional set of circumstances.

### Reasons valid commands fail and what to do about it

So we’ve got a well-behaved client that is sending valid commands, yet the server still decides to reject them. Often the circumstances for the rejection are related to other actors changing state relevant to the processing of that command.  
In the CRM example above, it is only because the billing event arrived first. But “first” could be a millisecond before our command. What if our user pressed the button a millisecond earlier? Should that actually change the **business outcome**? Shouldn’t we expect our system to behave the same when observed from the outside?  
So, if the billing event arrived second, shouldn’t that revert preferred customers to regular ones? Not only that, but shouldn’t the customer be notified of this, like by sending them an email? In which case, why not have this be the behavior for the case where the billing event arrives first? And if we’ve already got a notification model set up, do we really need to return an error to the customer service rep? I mean, it’s not like they can do anything about it **other than notifying the customer**.  
So, if we’re not returning errors to the client (who is already sending us valid commands), maybe all we need to do on the client when sending a command is to tell the user “thank you, you will receive confirmation via email shortly”. We don’t even need the UI widget showing pending commands.

### Commands and Autonomy

What we see is that in this model, commands don’t need to be processed immediately – they can be queued. How fast they get processed is a question of Service-Level Agreement (SLA) and not architecturally significant. This is one of the things that makes that node that processes commands autonomous from a runtime perspective – we don’t require an always-on connection to the client.  
Also, we shouldn’t need to access the query store to process commands – any state that is needed should be managed by the autonomous component – that’s part of the meaning of autonomy.  
Another part is the issue of failed message processing due to the database being down or hitting a deadlock. There is no reason that such errors should be returned to the client – we can just rollback and try again. When an administrator brings the database back up, all the message waiting in the queue will then be processed successfully and our users receive confirmation.  
The system as a whole is quite a bit more robust to any error conditions.  
Also, since we don’t have queries going through this database any more, the database itself is able to keep more rows/pages in memory which serve commands, improving performance. When both commands and queries were being served off of the same tables, the database server was always juggling rows between the two.

### Autonomous Components

While in the picture above we see all commands going to the same AC, we could logically have each command processed by a different AC, each with it’s own queue. That would give us visibility into which queue was the longest, letting us see very easily which part of the system was the bottleneck. While this is interesting for developers, it is critical for system administrators.  
Since commands wait in queues, we can now add more processing nodes behind those queues (using the distributor with NServiceBus) so that we’re only scaling the part of the system that’s slow. No need to waste servers on any other requests.

### Service Layers

Our command processing objects in the various autonomous components actually make up our service layer. The reason you don’t see this layer explicitly represented in CQRS is that it isn’t really there, at least not as an identifiable logical collection of related objects – here’s why:  
In the [layered architecture](http://en.wikipedia.org/wiki/Multitier_architecture) (AKA 3-Tier) approach, there is no statement about dependencies between objects within a layer, or rather it is implied to be allowed. However, when taking a command-oriented view on the service layer, what we see are objects handling different types of commands. Each command is independent of the other, so why should we allow the objects which handle them to depend on each other?  
Dependencies are things which should be avoided, unless there is good reason for them.  
Keeping the command handling objects independent of each other will allow us to more easily version our system, one command at a time, not needing even to bring down the entire system, given that the new version is backwards compatible with the previous one.  
Therefore, keep each command handler in its own VS project, or possibly even in its own solution, thus guiding developers away from introducing dependencies in the name of reuse (it’s a [fallacy](http://www.udidahan.com/2009/06/07/the-fallacy-of-reuse/)). If you do decide **as a deployment concern**, that you want to put them all in the same process feeding off of the same queue, you can ILMerge those assemblies and host them together, but understand that you will be undoing much of the benefits of your autonomous components.

### Whither the domain model?

Although in the diagram above you can see the domain model beside the command-processing autonomous components, it’s actually an implementation detail. There is nothing that states that all commands _must_ be processed by the same domain model. Arguably, you could have some commands be processed by [transaction script](http://martinfowler.com/eaaCatalog/transactionScript.html), others using [table module](http://martinfowler.com/eaaCatalog/tableModule.html) (AKA active record), as well as those using the [domain model](http://martinfowler.com/eaaCatalog/domainModel.html). Event-sourcing is another possible implementation.  
Another thing to understand about the domain model is that it now isn’t used to serve queries. So the question is, why do you need to have so many relationships between entities in your domain model?  
(You may want to take a second to let that sink in.)  
Do we really need a collection of orders on the customer entity? In what command would we need to navigate that collection? In fact, what kind of command would need _any_ one-to-many relationship? And if that’s the case for one-to-many, many-to-many would definitely be out as well. I mean, most commands only contain one or two IDs in them anyway.  
Any aggregate operations that may have been calculated by looping over child entities could be pre-calculated and stored as properties on the parent entity. Following this process across all the entities in our domain would result in isolated entities needing nothing more than a couple of properties for the IDs of their related entities – “children” holding the parent ID, like in databases.  
In this form, commands could be entirely processed by a single entity – viola, an aggregate root that is a consistency boundary.

### Persistence for command processing

Given that the database used for command processing is not used for querying, and that most (if not all) commands contain the IDs of the rows they’re going to affect, do we really need to have a column for every single domain object property? What if we just serialized the domain entity and put it into a single column, and had another column containing the ID? This sounds quite similar to key-value storage that is available in the various cloud providers. In which case, would you really need an object-relational mapper to persist to this kind of storage?  
You could also pull out an additional property per piece of data where you’d want the “database” to enforce uniqueness.  
I’m not suggesting that you do this in all cases – rather just trying to get you to rethink some basic assumptions.

### Let me reiterate

How you process the commands is an implementation detail of CQRS.

### Keeping the query store in sync

After the command-processing autonomous component has decided to accept a command, modifying its persistent store as needed, it publishes an event notifying the world about it. This event often is the “past tense” of the command submitted:  
MakeCustomerPerferredCommand -\> CustomerHasBeenMadePerferredEvent  
The publishing of the event is done transactionally together with the processing of the command and the changes to its database. That way, any kind of failure on commit will result in the event not being sent. This is something that should be handled by default by your message bus, and if you’re using MSMQ as your underlying transport, requires the use of transactional queues.  
The autonomous component which processes those events and updates the query data store is fairly simple, translating from the event structure to the persistent view model structure. I suggest having an event handler per view model class (AKA per table).  
Here’s the picture of all the pieces again:

![CQRS](Exported%20image%2020260209135108-2.png)

### Bounded Contexts

While CQRS touches on many pieces of software architecture, it is still not at the top of the food chain. CQRS if used is employed within a bounded context (DDD) or a business component (SOA) – a cohesive piece of the problem domain. The events published by one BC are subscribed to by other BCs, each updating their query and command data stores as needed.  
UI’s from the CQRS found in each BC can be “mashed up” in a single application, providing users a single composite view on all parts of the problem domain. Composite UI frameworks are very useful for these cases.

### Summary

CQRS is about coming up with an appropriate architecture for multi-user collaborative applications. It explicitly takes into account factors like data staleness and volatility and exploits those characteristics for creating simpler and more scalable constructs.  
One cannot truly enjoy the benefits of CQRS without considering the user-interface, making it capture user intent explicitly. When taking into account client-side validation, command structures may be somewhat adjusted. Thinking through the order in which commands and events are processed can lead to notification patterns which make returning errors unnecessary.  
While the result of applying CQRS to a given project is a more maintainable and performant code base, this simplicity and scalability require understanding the detailed business requirements and are not the result of any technical “best practice”. If anything, we can see a plethora of approaches to apparently similar problems being used together – data readers and domain models, one-way messaging and synchronous calls.  
Although this blog post is over 3000 words (a record for this blog), I know that it doesn’t go into enough depth on the topic (it takes about 3 days out of the 5 of my [Advanced Distributed Systems Design course](http://www.udidahan.com/training/) to cover everything in enough depth). Still, I hope it has given you the understanding of why CQRS is the way it is and possibly opened your eyes to other ways of looking at the design of distributed systems.  
Questions and comments are most welcome.

|   |   |   |
|---|---|---|
||If you liked this article, you might also like articles in these categories:  <br>  <br>[Architecture](https://udidahan.com/category/architecture/) \| [Autonomous Services](https://udidahan.com/category/autonomous-services/) \| [Business Rules](https://udidahan.com/category/business-rules/) \| [CQRS](https://udidahan.com/category/cqrs/) \| [Messaging](https://udidahan.com/category/messaging/) \| [Pub/Sub](https://udidahan.com/category/pubsub/) \| [Scalability](https://udidahan.com/category/scalability/) \| [Validation](https://udidahan.com/category/validation/)<br><br>  <br>[![Check out my Best Content](Exported%20image%2020260209135120-3.png)](https://udidahan.com/first-time-here/)<br><br>If you've got a minute, you might enjoy taking a look at some of my [best articles](https://udidahan.com/first-time-here/).  <br>I've gone through the hundreds of articles I've written over the past 6 years and put together a list of the best ones as ranked by my 5000+ readers.  <br>[You won't be disappointed.](http://www.udidahan.com/first-time-here/)  <br><br>[![Subscribe to my feed](Exported%20image%2020260209135135-4.png)](http://feeds.feedburner.com/UdiDahan-TheSoftwareSimplist)<br><br>If you'd like to get new articles sent to you when they're published, it's easy and **free**.  <br>[Subscribe right here](http://feeds.feedburner.com/UdiDahan-TheSoftwareSimplist).  <br><br>[![Follow me on Twitter](Exported%20image%2020260209135137-5.png)](http://twitter.com/UdiDahan)<br><br>Follow me on Twitter [@UdiDahan](http://twitter.com/UdiDahan).  <br>￼￼Something on your mind? Got a question? I'd be thrilled to hear it.  <br>Leave a comment below or [email me](mailto:questions@udidahan.com), whatever works for you.  <br>￼<br><br>_139 Comments_ \> [udidahan](http://www.udidahan.com/) Says:  <br>[September 21st, 2010 at 1:23 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5151)  <br><br>1. \> [udidahan](http://www.udidahan.com/) Says:  <br>    [September 21st, 2010 at 1:23 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5151)  <br>    <br><br>Maninder,  <br>I’d say that if the data does not need to be operated on by multiple actors collaboratively, then you might not need this approach. Highly complex non-collaborative domains may need it as well.<br><br>  <br>4. \> maninder Says:  <br>    [September 23rd, 2010 at 1:57 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5152)  <br>    <br><br>Udi,  <br>It seems like my last comment was not published. So let me retry hoping it is an idempotent operation<br><br>![Exported image](Exported%20image%2020260209135145-6.jpeg)<br><br>  <br>With my limited understanding, i see CQRS as a mechanism to scale read and writes.  <br>Can you please explain how multiple actors collaboratively or highly complex domain can benefit from it GIVEN the constraint “The reads and writes in that application do not need to scale independently”.<br><br>  <br>9. \> [udidahan](http://www.udidahan.com/) Says:  <br>    [September 23rd, 2010 at 2:38 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5153)  <br>    <br><br>Maninder,  <br>The technical form of using one-way commands enables scaling writes, and serving reads off of a type of cache has alway sbeen a way to scale queries. All that being said, if users don’t need to collaborate, each one is working on their own data, then you have an easily partitioned domain by user, rather than by separating reads and writes.<br><br>  <br>12. \> [joseph](http://josephonit.wordpress.com/) Says:  <br>    [March 2nd, 2011 at 8:06 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5154)  <br>    <br><br>Hi Udi  <br>Thanks a lot for this post, which indeed clarifies the CQRS topic.  <br>You said earlier you would post on Event Sourcing soon, but I didn’t find any related post (apart from the current one). Am I missing something ?  <br>It would be nice to have such a clear explanation on event sourcing, so.  <br>Anyway, thanks a lot<br><br>![Exported image](Exported%20image%2020260209135147-7.jpeg)  <br>16. \> [udidahan](http://www.udidahan.com/) Says:  <br>    [March 4th, 2011 at 1:15 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5155)  <br>    <br><br>Thanks for the nudge Joseph<br><br>![Exported image](Exported%20image%2020260209135148-8.jpeg)  <br>20. \> DavidZ Says:  <br>    [March 24th, 2011 at 4:00 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5156)  <br>    <br><br>When wil you pubish a book already<br><br>![Exported image](Exported%20image%2020260209135149-9.jpeg)<br><br>? I *think my frustration with CQRS and possibly a lot of posts here is that there really isn’t a bible for CQRS so to speak esspecially in relation to DDD+CQRS.  <br>Please oh please work on a book that will save me a lot of time and headache trying to google cqrs<br><br>![Exported image](Exported%20image%2020260209135151-10.jpeg)  <br>26. \> [udidahan](http://www.udidahan.com/) Says:  <br>    [March 28th, 2011 at 8:37 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5157)  <br>    <br><br>DavidZ,  <br>If only I had the time<br><br>![Exported image](Exported%20image%2020260209135156-11.jpeg)  <br>30. \> [joseph](http://josephonit.wordpress.com/) Says:  <br>    [March 29th, 2011 at 2:35 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5158)  <br>    <br><br>Hi Udi  <br>Another question came to my mind: would you recommend CQRS only for application when performance/scalability is of the uttermost importance or more as a pattern applicable to any application, like some intranet one?  <br>Having watched some of your talks on infoq I kind of had the feeling CQRS so much reducing the domain to its core that it would end up providing value anywhere, but most likely I’m just being over enthusiastic…  <br>thanks again  <br>best<br><br>  <br>33. \> [udidahan](http://www.udidahan.com/) Says:  <br>    [March 29th, 2011 at 3:05 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5159)  <br>    <br><br>Joseph,  <br>I wouldn’t say that performance/scalability are the deciding factors towards choosing CQRS – but they do contribute. The primary property of a system that would make it a good fit for CQRS is whether it is collaborative – ergo multiple users/actors working in parallel on a shared set of data.  <br>It is likely that there are parts of a system that are collaborative, and parts that aren’t. As such, CQRS should only be used for the collaborative parts.<br><br>  <br>36. \> [joseph](http://josephonit.wordpress.com/) Says:  <br>    [March 30th, 2011 at 2:04 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5160)  <br>    <br><br>Thanks again for this clarification udi, really helpful as usual.  <br>Mind if someday I translate this article in french and link back to your post ?  <br>best  <br>joseph<br><br>  <br>39. \> [udidahan](http://www.udidahan.com/) Says:  <br>    [March 30th, 2011 at 2:10 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5161)  <br>    <br><br>Joseph,  <br>That would be great – thanks.<br><br>  <br>42. \> brouce.liu Says:  <br>    [April 14th, 2011 at 8:23 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5162)  <br>    <br><br>hi, udi, I’m very interested in your diagram about CQRS.  <br>And would you like to let me know what tool to draw this diagram?  <br>Thanks in advanced.<br><br>  <br>45. \> [udidahan](http://www.udidahan.com/) Says:  <br>    [April 15th, 2011 at 2:49 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5163)  <br>    <br><br>Brouce,  <br>I use powerpoint.<br><br>  <br>48. \> Sanket Naik Says:  <br>    [May 3rd, 2011 at 9:04 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5164)  <br>    <br><br>Great Post Udi.<br><br>  <br>51. \> Michal Says:  <br>    [June 18th, 2012 at 9:30 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5165)  <br>    <br><br>Hi Udi.  <br>I have a couple of design questions about applying CQS in non-distributed envirnoment (possible integrations). Ill be very thankfull if You’ll share some experience with me.  <br>1. Obviously query is synchronous call, but… should we return data in form of DTO or just DataTable or DataSet. Some articles says that DataTable is enough but I have really horrible experience with it (easy to break something by changing columns names, and when project is changed very often -\> hell) DTOs gives cenrtalized mappings.  <br>Ive came to something like query objects (repositories doesnt provide anything in age of ‘big’ orms).  <br>interface IQueryPerformer  <br>{  <br>TResult Perform(IQuery query);  <br>}  <br>IntelliSense/Resharper is helping a lot when we type for example:  <br>List documents = QP.Perform(new …);  <br>2.By using this approach Ive moved into another issue. Are queries part of service(gets data contained by service) or queries are universal and all lives inside one place?  <br>Whats Your way to deal with querying data? Somekind of best practice for medium size projects (non high available)  <br>3.Commands, sent over somekind of bus or command processor. What kind of validations are performed before sending command? Only client side validations(filled field ect)? Or also domain validations(some specific business rules)?  <br>I would like to perform domain validations inside a handler, but then – how to return results from command?  <br>For example:  <br>WebForms/MVC (doesn’t matter)  <br>Under click handler we are performing some basic validations of fields. If command is valid to send, we are sending.  <br>Then some commandHandler handles command and starts business rules validation, what we should do if something goes wrong and command cant be processed? Throw exception? But what if we must just return specific result of processing, like ID of new created contract, product, ect?  <br>We can’t assume that command will success, unless will pull out business rules validations from inside of domain. (and Im not 100% sure about that)  <br>Kind Regards  <br>Michal Samociuk<br><br>  <br>54. \> Samuel Says:  <br>    [June 25th, 2012 at 6:38 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5166)  <br>    <br><br>“What if we just serialised the domain entity and put it into a single  <br>column, and had another column containing the ID? This sounds quite similar to key-value storage that  <br>is available in the various cloud providers. In which case, would you really need an object-relational  <br>mapper to persist to this kind of storage?  <br>You could also pull out an additional property per piece of data where you’d want the “database” to  <br>enforce uniqueness.  <br>I’m not suggesting”  <br>I don’t agree with some of the assumptions you have here, but this one I think is just so plain wrong. So should we drop almost everything that was built in terms of software development and replace it with this nonsense? Since when did data referential integrity become a second level citizen in the system?! I thought that data was way too important. Hell, almost of the software running in the world does just the opposite, implementing proper referential integrity. Also in relation to this?  <br>“Another thing to understand about the domain model is that it now isn’t used to serve queries. So the  <br>question is, why do you need to have so many relationships between entities in your domain model?”  <br>I would love to see such a system. So the system has to process commands and do some validations… where is the data for the validations going to be read from?  <br>You do have some good ideas in here, but there are a few, that with all respect, are just nonsense.<br><br>  <br>57. \> dgi Says:  <br>    [October 28th, 2012 at 2:56 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5167)  <br>    <br><br>“So, if we’re not returning errors to the client (who is already sending us valid commands), maybe all we need to do on the client when sending a command is to tell the user “thank you, you will receive confirmation via email shortly”. We don’t even need the UI widget showing pending commands.”  <br>This sentence tells us above CQRS That is only for (about) 5% of applications build upon customer needs.  <br>At least my experience in building applications for clients indicates those 5%.<br><br>  <br>60. \> [udidahan](http://www.udidahan.com/) Says:  <br>    [October 30th, 2012 at 1:57 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5168)  <br>    <br><br>dgi,  <br>Yes, this UI facing application form of CQRS isn’t applicable everywhere – I’ve said as much many times. This is mostly focused on collaborative environments.<br><br>  <br>63. \> Gleb Says:  <br>    [November 14th, 2012 at 3:25 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5169)  <br>    <br><br>Hello.  <br>First of all, thanks for a great article.  <br>I have a question – if my system has, let’s say, 60% writes and 40% reads and changes displayed on the screen need to be up to date every time, does it mean that CQRS doesn’t suit me?<br><br>  <br>66. \> Gleb Says:  <br>    [November 14th, 2012 at 3:31 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5170)  <br>    <br><br>Also, I must admit that after reading Evans’ book on DDD I got even more confused than before I read it<br><br>![Exported image](Exported%20image%2020260209135158-12.jpeg)<br><br>Many people say it’s a great book, and I’m not saying it’s not, but I think I understand about 25% of it if not less.  <br>Can you recommend some other book on DDD, Jimmy Nilsson’s may be?<br><br>  <br>71. \> [udidahan](http://www.udidahan.com/) Says:  <br>    [November 18th, 2012 at 5:22 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5171)  <br>    <br><br>Gleb,  <br>You may be better served with simple CRUD (no extra layers) for some parts of your system, with CQRS coming in to play for more background processes.<br><br>  <br>74. \> Gleb Says:  <br>    [November 20th, 2012 at 3:29 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5172)  <br>    <br><br>I see. What about the book? Any suggestions? May be I should re-read the Evans book?<br><br>  <br>77. \> [udidahan](http://www.udidahan.com/) Says:  <br>    [November 22nd, 2012 at 7:30 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5173)  <br>    <br><br>There’s a new book coming out from Vaughn Vernon called Implementing DDD that will probably help you out quite a bit:  <br>[http://www.amazon.com/Implementing-Domain-Driven-Design-Vaughn-Vernon/dp/0321834577](http://www.amazon.com/Implementing-Domain-Driven-Design-Vaughn-Vernon/dp/0321834577)<br><br>  <br>80. \> Gleb Says:  <br>    [November 22nd, 2012 at 11:54 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5174)  <br>    <br><br>Thanks! Will definitely follow book’s reviews<br><br>  <br>83. \> [Simon Dowdeswell](http://isipl.com/) Says:  <br>    [December 11th, 2013 at 12:48 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5175)  <br>    <br><br>Ive been reading in many places about the use of queues between the web and worker to increase scalability. Im facing a challenge to move an existing system (over 10 years old code) to the Cloud and this pattern appears to be one of the first to adopt for Cloud performance/cost reasons. My question is one you have already faced several times in this blog (but I am not convinced), and i bet its the most common one you face – How does the (asynchronously initiated) worker report information on broken business rules back to the user ? The most common answer in the info ive come across is “by email”. While this works for Amazon, it wont work for the majority of business applications – the application should show them … somehow. Have you come across agreeable mechanisms for this – would you ever build the “Display Widget” you cast out in the blog or do you consider it wrong to do so ?<br><br>  <br>86. \> [udidahan](http://www.udidahan.com/) Says:  <br>    [December 21st, 2013 at 12:18 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5176)  <br>    <br><br>Simon,  <br>You can use technologies like SignalR to push notifications back to the browser which initiated the action.  <br>Cheers,  <br>Udi<br><br>  <br>89. \> EDH Says:  <br>    [July 18th, 2015 at 4:33 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5177)  <br>    <br><br>Hello,  <br>Interesting post.  <br>However it’s not clear when the query model and database are used, and when the “command” model and database are used.  <br>Is the query model/database purely used for more reporting-like use cases, or is it used for all queries ?  <br>E.g. if a user has the intent to delete a particular product, then typically the user is shown a page with a list of products (= query) first. From which he then can pick the product he wants to delete (= command).  <br>Is the query database also used for these kind of use cases ?<br><br>  <br>92. \> EDH Says:  <br>    [July 18th, 2015 at 4:37 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5178)  <br>    <br><br>With regards to  <br>“Also, we shouldn’t need to access the query store to process commands – any state that is needed should be managed by the autonomous component – that’s part of the meaning of autonomy”  <br>Is that a feasible assumption ?  <br>How do you see this working, given the fact that command validation will (?) most probably always require fetching some information from the query store (e.g. street name) ?  <br>Or is the assumption that for server-side command validation no data is fetched from the query store ? If that’s the assumption then where does the data come from ?<br><br>  <br>95. \> [udidahan](http://www.udidahan.com/) Says:  <br>    [July 23rd, 2015 at 5:38 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5179)  <br>    <br><br>EDH,  <br>When it comes to “private data” – things that a user is working on by themselves before it is accessible to other users/processes, you would often be better served by applying simple CRUD techniques rather than CQRS.  <br>When you’re in a more collaborative/high-contention domain, that when you need to start applying a CQRS approach. In practice, that means when processing a command that requires history, that that command processor will have held on to previous commands/events that caused that history, and use them instead of fetching information from the query store.<br><br>  <br>98. \> Sai Theodore Says:  <br>    [September 9th, 2015 at 8:18 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-10090)  <br>    <br><br>Hi Udi, a great article; still coming to terms with it. One doubt that was lingering when I first read the article was the challenge in keeping the data stores in sync. Whenever an event is published, the query store needs to pull “updated” information from the master db. In a system where there could be tons of commands that needs to be processed, wouldn’t the pulls become a bottleneck, choking the master db? Am I missing something here?<br><br>  <br>101. \> [udidahan](http://www.udidahan.com/) Says:  <br>    [September 21st, 2015 at 1:34 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-14488)  <br>    <br><br>Hi Sai,  <br>Usually the event being published would include everything needed for updated the query store such that the master db wouldn’t need to be pulled from.<br><br>  <br>104. \> Nazac Says:  <br>    [December 30th, 2015 at 5:40 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-34448)  <br>    <br><br>Hello,  <br>I am implementing CQRS with DDD without event sourcing. So I put commands and their handlers in the Application Layer instead of Domain layer. I do validation for required fields in the command handler and if all are valid, I interact with the domain from the handler like this:  <br>public void Handle(ConfirmOrder command)  <br>{  <br>// validation here…  <br>var order = repository.Get(command.OrderId);  <br>order.Confirm();  <br>repository.Save(order, command.Id.ToString());  <br>}  <br>Is it ok to put the commands and their handlers outside the domain in the Application Layer?  <br>Thanks.<br><br>  <br>107. \> [udidahan](http://www.udidahan.com/) Says:  <br>    [January 1st, 2016 at 3:19 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-34862)  <br>    <br><br>Nazac,  <br>Yes, that’s fine.<br><br>  <br>110. \> Merlyn Says:  <br>    [April 8th, 2016 at 2:00 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-57525)  <br>    <br><br>Two things, in question after your statements on simple one-or-two object commands.  <br>1:  <br>\> most commands only contain one or two IDs in them anyway.  <br>I’ve seen a lot of call for “fat” interfaces for the web, argued either for latency sake, or for atomicity, or both. I might be willing to throw some of that out, but I want to drill into it first.  <br>If you’re trying to enable a minimum-steps interface for a user (you used some form of e-commerce as an example in this article), you would potentially submit a lot of information at once – name, address, credit card, and cart id, all at the same time. These, in typical old-school apps with less inline validation, might all be validated upon submission.  <br>I suppose it could at least be partially broken down to client-side validation first. Even upon client side validation, though, it is probably still useful to do validation at the submission level, as the “create an order with this cart sent to me” is a somewhat atomic action. Do you think submission should be broken up on the command side, even if it is not broken up on the UI side? If so, how might you break it up? I see this typically used in a “guest” use case.  <br>Another example for this question might be the comment submission box I’m typing into right now. There’s 4 fields, and although I am not creating a user account, some commenting systems *would* do this, creating both a comment *and* a user. Same question – break that up into two commands, or leave it as one?  <br>2:  <br>\> In fact, what kind of command would need any one-to-many relationship? And if that’s the case for one-to-many, many-to-many would definitely be out as well.  <br>Still sort of re fat interfaces, but maybe it’s about necessarily list-oriented tasks…  <br>Concurrently editing a list of things to modify their relative order seems like a case to me. Like sorting a list of pictures in an album, or re-ordering a Netflix queue or song playlist (before arguing that this wouldn’t happen concurrently, maybe it is shared with a trusted group and changed collaboratively? “Curation” is a big buzzword on the wide-open net these days, or at least was a couple years back…). Would you suggest modeling it in such a way that each modification would send an individual command, or would you batch it somehow?  <br>And admittedly less inherently inter-dependent, what about batching? For a simple case, deleting a set of items you’ve checked off in a trello board (shared set of digital note cards). I can see the individual deletions aren’t dependent on each other, but for “fat interface” sake, could they be one batched command? Should they, or should it be broken down into individual removals, and if so, what about partial failures, for example on a shoddy internet connection. Wouldn’t a user expect it to be atomic if the interface appears atomic?  <br>If you were to try to model batches, would you suggest a “batch cart” style, or would you be okay with and/or recommend list-oriented commands?  <br>This of course doesn’t effect the data model, where you’re suggesting that children point to parent rather that vice-versa, but it certain makes command validation more challenging.  <br>III:  <br>One last question that’s less directly related – Would you suggest doing CQRS for real-time inter-dependent collaboration (ala google docs) or something unique, since latency and immediately being informed of other actor’s updates are a concern?  <br>I am thinking CQRS might not be so great for such a model, although admittedly tools like this are rare, and maybe not terribly important from an absolute perspective, though I see more and more hot-editing stuff coming out these last few years (Firebase, online code editors, etc), so maybe we’ll hit a true killer app on this use case soon.  <br>—  <br>Re my examples: I know I might be trying to over-apply CQRS, though to me the SRP benefits of the generic form of the pattern might still fit into a “monolithic” module and deployment design, and still be fairly painless to code. To me, at an abstract level, it’s just SRP, except with the understanding that read/writes are quite different, and thus maybe you should simplify/split your states as well. I will probably blog about it some day if I end up having success applying it “in the small”<br><br>![Exported image](Exported%20image%2020260209135200-13.jpeg)<br><br>3 layers are already “a lot” to me, yet still seen by me and plenty others to be valuable. See a rails apps for “3 tiers is simple”. To me this pattern just says that there are actually partitions within your layers… (ignoring stuff like Event Sourcing).<br><br>  <br>115. \> [udidahan](http://www.udidahan.com/) Says:  <br>    [May 8th, 2016 at 2:11 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-64939)  <br>    <br><br>Merlyn,  <br>See some of my posts on composite UIs to see how each “logical service” would be collecting its own parts of the data submitted.  <br>To see how those can be physically recomposed for the performance needs of remote calls over HTTP, see this post:  <br>[http://udidahan.com/2014/07/30/service-oriented-composition-with-video/](http://udidahan.com/2014/07/30/service-oriented-composition-with-video/)  <br>When it comes to real-time collaborative domains (like Google Docs), there is so much more significant UX analysis to do that it’s not really possible to make generic statements about the applicability of any technical approach.  <br>Hope that helps.<br><br>  <br>118. \> Jeremy Says:  <br>    [December 1st, 2016 at 6:57 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-87359)  <br>    <br><br>So when you implement a microservice (quoting, for example), you have the command side and the query side. What are those in reality? Is it a single process like a web api? Or are the command query sides separate executables like a windows service for command and web api for query?<br><br>  <br>121. \> [udidahan](http://www.udidahan.com/) Says:  <br>    [December 16th, 2016 at 8:14 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-89969)  <br>    <br><br>Jeremy,  <br>I’d say that CQRS is a higher-level architectural pattern than microservices, so you probably wouldn’t be looking to apply CQRS *to* a microservice.<br><br>  <br>124. \> Jonathan Says:  <br>    [July 9th, 2017 at 3:32 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-103499)  <br>    <br><br>Hi Udi,  <br>Your article is a few years old but was a great read for someone like me who is starting to study these kinds of architecture. As stated in another comment, it is great that your focus is on CQRS only without mixing things up with event sourcing and other concepts often associated with CQRS in other articles.  <br>My question focus on the transaction that write to the master and publish the event. The master and the event queue are most probably be different (for example a relational database and another AC as in your schema or a message queue). How can you ensure that both writes have succeeded and revert any change if one did not ? You have mecanism like 2PC but they often have some serious drawbacks.  <br>Do you have any recommendation on how to approach this issue ?  <br>I think that’s why I often read about articles explaining CQRS in event sourcing architecture. Solutions like Kafka seem to handle this issue as it provides in a single all-in-one system the event log and the master (built from the event log history).  <br>Thanks.  <br>I am going to look into your “best of the best” article too.<br><br>  <br>127. \> [udidahan](http://www.udidahan.com/) Says:  <br>    [September 3rd, 2017 at 11:29 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-106388)  <br>    <br><br>Hi Jonathan,  <br>This is exactly what the Outbox pattern we’ve implemented in NServiceBus does:  <br>[https://docs.particular.net/nservicebus/outbox/](https://docs.particular.net/nservicebus/outbox/)<br><br>  <br><br>  <br>\> maninder Says:  <br>[September 23rd, 2010 at 1:57 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5152)  <br>  <br>\> [udidahan](http://www.udidahan.com/) Says:  <br>[September 23rd, 2010 at 2:38 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5153)  <br>  <br>\> [joseph](http://josephonit.wordpress.com/) Says:  <br>[March 2nd, 2011 at 8:06 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5154)  <br>  <br>\> [udidahan](http://www.udidahan.com/) Says:  <br>[March 4th, 2011 at 1:15 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5155)  <br>  <br>\> DavidZ Says:  <br>[March 24th, 2011 at 4:00 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5156)  <br>  <br>\> [udidahan](http://www.udidahan.com/) Says:  <br>[March 28th, 2011 at 8:37 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5157)  <br>  <br>\> [joseph](http://josephonit.wordpress.com/) Says:  <br>[March 29th, 2011 at 2:35 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5158)  <br>  <br>\> [udidahan](http://www.udidahan.com/) Says:  <br>[March 29th, 2011 at 3:05 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5159)  <br>  <br>\> [joseph](http://josephonit.wordpress.com/) Says:  <br>[March 30th, 2011 at 2:04 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5160)  <br>  <br>\> [udidahan](http://www.udidahan.com/) Says:  <br>[March 30th, 2011 at 2:10 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5161)  <br>  <br>\> brouce.liu Says:  <br>[April 14th, 2011 at 8:23 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5162)  <br>  <br>\> [udidahan](http://www.udidahan.com/) Says:  <br>[April 15th, 2011 at 2:49 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5163)  <br>  <br>\> Sanket Naik Says:  <br>[May 3rd, 2011 at 9:04 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5164)  <br>  <br>\> Michal Says:  <br>[June 18th, 2012 at 9:30 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5165)  <br>  <br>\> Samuel Says:  <br>[June 25th, 2012 at 6:38 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5166)  <br>  <br>\> dgi Says:  <br>[October 28th, 2012 at 2:56 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5167)  <br>  <br>\> [udidahan](http://www.udidahan.com/) Says:  <br>[October 30th, 2012 at 1:57 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5168)  <br>  <br>\> Gleb Says:  <br>[November 14th, 2012 at 3:25 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5169)  <br>  <br>\> Gleb Says:  <br>[November 14th, 2012 at 3:31 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5170)  <br>  <br>\> [udidahan](http://www.udidahan.com/) Says:  <br>[November 18th, 2012 at 5:22 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5171)  <br>  <br>\> Gleb Says:  <br>[November 20th, 2012 at 3:29 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5172)  <br>  <br>\> [udidahan](http://www.udidahan.com/) Says:  <br>[November 22nd, 2012 at 7:30 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5173)  <br>  <br>\> Gleb Says:  <br>[November 22nd, 2012 at 11:54 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5174)  <br>  <br>\> [Simon Dowdeswell](http://isipl.com/) Says:  <br>[December 11th, 2013 at 12:48 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5175)  <br>  <br>\> [udidahan](http://www.udidahan.com/) Says:  <br>[December 21st, 2013 at 12:18 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5176)  <br>  <br>\> EDH Says:  <br>[July 18th, 2015 at 4:33 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5177)  <br>  <br>\> EDH Says:  <br>[July 18th, 2015 at 4:37 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5178)  <br>  <br>\> [udidahan](http://www.udidahan.com/) Says:  <br>[July 23rd, 2015 at 5:38 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-5179)  <br>  <br>\> Sai Theodore Says:  <br>[September 9th, 2015 at 8:18 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-10090)  <br>  <br>\> [udidahan](http://www.udidahan.com/) Says:  <br>[September 21st, 2015 at 1:34 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-14488)  <br>  <br>\> Nazac Says:  <br>[December 30th, 2015 at 5:40 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-34448)  <br>  <br>\> [udidahan](http://www.udidahan.com/) Says:  <br>[January 1st, 2016 at 3:19 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-34862)  <br>  <br>\> Merlyn Says:  <br>[April 8th, 2016 at 2:00 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-57525)  <br>  <br>\> [udidahan](http://www.udidahan.com/) Says:  <br>[May 8th, 2016 at 2:11 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-64939)  <br>  <br>\> Jeremy Says:  <br>[December 1st, 2016 at 6:57 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-87359)  <br>  <br>\> [udidahan](http://www.udidahan.com/) Says:  <br>[December 16th, 2016 at 8:14 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-89969)  <br>  <br>\> Jonathan Says:  <br>[July 9th, 2017 at 3:32 pm](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-103499)  <br>  <br>\> [udidahan](http://www.udidahan.com/) Says:  <br>[September 3rd, 2017 at 11:29 am](https://udidahan.com/2009/12/09/clarified-cqrs/#comment-106388)  <br>  <br>_Your comment..._<br><br>Name (required)  <br>Mail (will not be published) (required)  <br>Website  <br>  <br>  <br>If this is your first time commenting, it may take a while to show up.  <br>I'm working to make that better.  <br>￼ [Subscribe here to receive updates on comments](https://udidahan.com/comments/feed/).||

|   |   |   |
|---|---|---|
|[![Dont miss my best content](Exported%20image%2020260209135202-14.png)](https://udidahan.com/first-time-here/)|||
 
Recommendations
 
[Bryan Wheeler, Director Platform Development at msnbc.com](http://www.linkedin.com/profile/recommendations?id=1943218&authType=name&authToken=hSJ-#rec22295049)  
“**Udi Dahan is the real deal.**  
**￼****We brought him on site to give our development staff the 5-day “Advanced Distributed System Design” training. The course profoundly changed our understanding and approach to SOA and distributed systems.**  
**￼****Consider some of the evidence: 1. Months later, developers still make allusions to concepts learned in the course nearly every day 2. One of our developers went home and made her husband (a developer at another company) sign up for the course at a subsequent date/venue 3. Based on what we learned, we’ve made constant improvements to our architecture that have helped us to adapt to our ever changing business domain at scale and speed If you have the opportunity to receive the training, you will make a substantial paradigm shift.**  
**￼****If I were to do the whole thing over again, I’d start the week by playing the clip from the Matrix where Morpheus offers Neo the choice between the red and blue pills. Once you make the intellectual leap, you’ll never look at distributed systems the same way.**  
**￼****Beyond the training, we were able to spend some time with Udi discussing issues unique to our business domain. Because Udi is a rare combination of a big picture thinker and a low level doer, he can quickly hone in on various issues and quickly make good (if not startling) recommendations to help solve tough technical issues.” November 11, 2010**  
**￼****Sam Gentile, Independent WCF & SOA Expert**  
**“Udi, one of the great minds in this area.**  
**A man I respect immensely.”**  
**￼****￼****￼****￼****￼****Ian Robinson, Principal Consultant at ThoughtWorks**  
**"Your blog and articles have been enormously useful in shaping, testing and refining my own approach to delivering on SOA initiatives over the last few years. Over and against a certain 3-layer-application-architecture-blown-out-to- distributed-proportions school of SOA,** **your writing, steers a far more valuable course**."  
￼[Shy Cohen, Senior Program Manager at Microsoft](http://www.linkedin.com/in/shycohen)  
“Udi is a world renowned software architect and speaker. I met Udi at a conference that we were both speaking at, and immediately recognized his keen insight and razor-sharp intellect. Our shared passion for SOA and the advancement of its practice launched a discussion that lasted into the small hours of the night.  
It was evident through that discussion that Udi is one of the most knowledgeable people in the SOA space. It was also clear why – Udi does not settle for mediocrity, and seeks to fully understand (or define) the logic and principles behind things.  
Humble yet uncompromising, Udi is a pleasure to interact with.”  
￼[Glenn Block, Senior Program Manager - WCF at Microsoft](http://www.linkedin.com/in/gblock)  
“I have known Udi for many years having attended his workshops and having several personal interactions including working with him when we were building our Composite Application Guidance in patterns & practices. **What impresses me about Udi is his deep insight into how to address business problems through sound architecture**. Backed by many years of building mission critical real world distributed systems it is no wonder that Udi is the best at what he does. When customers have deep issues with their system design, I point them Udi's way.”  
￼[Karl Wannenmacher, Senior Lead Expert at Frequentis AG](https://www.xing.com/profile/Karl_Wannenmacher)  
“I have been following Udi’s blog and podcasts since 2007. I’m convinced that he is one of the most knowledgeable and experienced people in the field of SOA, EDA and large scale systems.  
Udi helped Frequentis to design a major subsystem of a large mission critical system with a **nationwide deployment based on NServiceBus**. It was impressive to see how he took the initial architecture and turned it upside down leading to a very flexible and scalable yet simple system without knowing the details of the business domain. I highly recommend consulting with Udi when it comes to large scale mission critical systems in any domain.”  
￼[Simon Segal, Independent Consultant](http://www.linkedin.com/in/simonsegal)  
“Udi is one of the outstanding software development minds in the world today, his vast insights into Service Oriented Architectures and Smart Clients in particular are indeed a rare commodity. **Udi is also an exceptional teacher** and can help lead teams to fall into the pit of success. I would recommend Udi to anyone considering some Architecural guidance and support in their next project.”  
￼[Ohad Israeli, Chief Architect at Hewlett-Packard, Indigo Division](http://www.linkedin.com/in/ohadisraeli)  
“When you need a man to do the job Udi is your man! No matter if you are facing near deadline deadlock or at the early stages of your development, if you have a problem Udi is the one who will probably be able to solve it, with his large experience at the industry and his widely horizons of thinking , he is always **full of just in place great architectural ideas**.  
I am honored to have Udi as a colleague and a friend (plus having his cell phone on my speed dial).”  
￼[Ward Bell, VP Product Development at IdeaBlade](http://www.linkedin.com/pub/0/b08/1a9)  
“Everyone will tell you how smart and knowledgable Udi is ... and they are oh-so-right. Let me add that Udi is a smart LISTENER. He's always calibrating what he has to offer with your needs and your experience ... looking for the fit. He has strongly held views ... and the ability to temper them with the nuances of the situation.  
I trust Udi to tell me what I need to hear, even if I don't want to hear it, ... in a way that I can hear it. That's a rare skill to go along with his command and intelligence.”  
￼[Eli Brin, Program Manager at RISCO Group](http://www.linkedin.com/pub/8/314/674)  
“We hired Udi as a SOA specialist for a large scale project. The development is outsourced to India. SOA is a buzzword used almost for anything today. We wanted to understand what SOA really is, and what is the meaning and practice to develop a SOA based system.  
We identified Udi as the one that can put some sense and order in our minds. We started with a private customized SOA training for the entire team in Israel. After that I had several focused sessions regarding our architecture and design.  
I will summarize it simply (as he is the software simplist): We are very happy to have Udi in our project. It has a great benefit. We feel good and assured with the knowledge and practice he brings. **He doesn’t talk over our heads**. We assimilated nServicebus as the ESB of the project. I highly recommend you to bring Udi into your project.”  
￼[Catherine Hole, Senior Project Manager at the Norwegian Health Network](http://www.linkedin.com/pub/cathrine-hole/0/6a3/666)  
“My colleagues and I have spent five interesting days with Udi - diving into the many aspects of SOA. Udi has shown impressive abilities of understanding organizational challenges, and has brought the business perspective into our way of looking at services. He has an excellent understanding of the many layers from business at the top to the technical infrstructure at the bottom. He is a great listener, and manages to simplify challenges in a way that is **understandable both for developers and CEOs, and all the specialists in between**.”  
￼[Yoel Arnon, MSMQ Expert](http://www.linkedin.com/in/yoelarnon)  
“Udi has a unique, in depth understanding of service oriented architecture and **how it should be used in the real world**, combined with excellent presentation skills. I think Udi should be a premier choice for a consultant or architect of distributed systems.”  
￼[Vadim Mesonzhnik, Development Project Lead at Polycom](http://www.linkedin.com/pub/1/a1/607)￼ “When we were faced with a task of creating a high performance server for a video-tele conferencing domain we decided to opt for a stateless cluster with SQL server approach. In order to confirm our decision we invited Udi.  
￼After carefully listening for 2 hours he said: "With your kind of high availability and performance requirements you don’t want to go with stateless architecture."  
￼One simple sentence saved us from implementing a wrong product and finding that out after years of development. No matter whether our former decisions were confirmed or altered, it gave us great confidence to move forward relying on the experience, industry best-practices and time-proven techniques that Udi shared with us.  
It was a distinct pleasure and a unique opportunity to learn from someone who is among the best at what he does.”  
￼[Jack Van Hoof, Enterprise Integration Architect at Dutch Railways](http://www.linkedin.com/in/jackvanhoof)  
“Udi is a respected visionary on SOA and EDA, whose opinion I most of the time (if not always) highly agree with. **The nice thing about Udi is that he is able to explain architectural concepts in terms of practical code-level examples**.”  
￼[Neil Robbins, Applications Architect at Brit Insurance](http://neildoesdotnet.blogspot.com/)  
“Having followed Udi's blog and other writings for a number of years I attended Udi's two day course on 'Loosely Coupled Messaging with NServiceBus' at SkillsMatter, London.  
￼I would strongly recommend this course to anyone with an interest in how to develop IT systems which provide immediate and future fitness for purpose. An influential and innovative thought leader and practitioner in his field, Udi demonstrates and shares a phenomenally in depth knowledge that proves his position as one of the premier experts in his field globally.  
￼The course has enhanced my knowledge and skills in ways that I am able to immediately apply to provide benefits to my employer. Additionally though I will be able to build upon what I learned in my 2 days with Udi and have no doubt that it will only enhance my future career.  
￼I cannot recommend Udi, and his courses, highly enough.”  
￼[Nick Malik, Enterprise Architect at Microsoft Corporation](http://www.linkedin.com/pub/1/763/999)  
“**You are an excellent speaker and trainer, Udi**, and I've had the fortunate experience of having attended one of your presentations. I believe that you are a knowledgable and intelligent man.”  
￼[Sean Farmar, Chief Technical Architect at Candidate Manager Ltd](http://www.linkedin.com/pub/6/668/107)  
“Udi has provided us with guidance in system architecture and supports our implementation of NServiceBus in our core business application.  
￼He accompanied us in all stages of our development cycle and helped us put vision into real life distributed scalable software. He brought fresh thinking, great in depth of understanding software, and ongoing support that proved as valuable and cost effective.  
￼Udi has the unique ability to analyze the business problem and come up with a simple and elegant solution for the code and the business alike.  
With Udi's attention to details, and knowledge we avoided pit falls that would cost us dearly.”  
￼[Børge Hansen, Architect Advisor at Microsoft](http://www.linkedin.com/in/borge3000)  
“Udi delivered a 5 hour long workshop on SOA for aspiring architects in Norway. While **keeping everyone awake and excited** Udi gave us some great insights and really delivered on making complex software challenges simple. Truly the software simplist.”  
￼[Motty Cohen, SW Manager at KorenTec Technologies](http://www.linkedin.com/pub/7/678/b2b)  
“I know Udi very well from our mutual work at KorenTec. During the analysis and design of a complex, distributed C4I system - where the basic concepts of NServiceBus start to emerge - I gained a lot of "Udi's hours" so I can surely say that he is a professional, skilled architect with **fresh ideas and unique perspective** for solving complex architecture challenges. His ideas, concepts and parts of the artifacts are the basis of several state-of-the-art C4I systems that I was involved in their architecture design.”  
￼

![Aaron Jensen](Exported%20image%2020260209135203-15.png)

[Aaron Jensen, VP of Engineering at Eleutian Technology](http://www.linkedin.com/in/aaronjensen)  
“**Awesome. Just awesome.**  
￼We’d been meaning to delve into messaging at Eleutian after multiple discussions with and blog posts from Greg Young and Udi Dahan in the past. We weren’t entirely sure where to start, how to start, what tools to use, how to use them, etc. Being able to sit in a room with Udi for an entire week while he described exactly how, why and what he does to tackle a massive enterprise system was invaluable to say the least.  
￼We now have a much better direction and, more importantly, have the confidence we need to start introducing these powerful concepts into production at Eleutian.”  
￼[Gad Rosenthal, Department Manager at Retalix](http://www.linkedin.com/pub/7/601/542)  
“A thinking person. Brought fresh and valuable ideas that helped us in architecting our product. **When recommending a solution he supports it with evidence and detail so you can successfully act based on it**. Udi's support "comes on all levels" - As the solution architect through to the detailed class design. Trustworthy!”  
￼[Chris Bilson, Developer at Russell Investment Group](http://www.linkedin.com/pub/0/15/338)  
“I had the pleasure of attending a workshop Udi led at the Seattle ALT.NET conference in February 2009. I have been reading Udi's articles and listening to his podcasts for a long time and have always looked to him as a source of advice on software architecture.  
When I actually met him and talked to him I was even more impressed. **Not only is Udi an extremely likable person, he's got that rare gift of being able to explain complex concepts and ideas in a way that is easy to understand**.  
All the attendees of the workshop greatly appreciate the time he spent with us and the amazing insights into service oriented architecture he shared with us.”  
￼[Alexey Shestialtynov, Senior .Net Developer at Candidate Manager](http://www.linkedin.com/pub/1/266/a3)  
“I met Udi at Candidate Manager where he was brought in part-time as a consultant to help the company make its flagship product more scalable. For me, even after 30 years in software development, **working with Udi was a great learning experience**. I simply love his fresh ideas and architecture insights.  
As we all know it is not enough to be armed with best tools and technologies to be successful in software - there is still human factor involved. When, as it happens, the project got in trouble, management asked Udi to step into a leadership role and bring it back on track. This he did in the span of a month. I can only wish that things had been done this way from the very beginning.  
I look forward to working with Udi again in the future.”  
￼[Christopher Bennage, President at Blue Spire Consulting, Inc.](http://www.linkedin.com/pub/1/266/a3)  
“My company was hired to be the primary development team for a large scale and highly distributed application. Since these are not necessarily everyday requirements, we wanted to bring in some additional expertise. We chose Udi because of his blogging, podcasting, and speaking. We asked him to to review our architectural strategy as well as the overall viability of project.  
I was very impressed, as Udi demonstrated a broad understanding of the sorts of problems we would face. His advice was honest and unbiased and very pragmatic. Whenever I questioned him on particular points, he was able to backup his opinion with real life examples. I was also impressed with his clarity and precision. He was very careful to untangle the meaning of words that might be overloaded or otherwise confusing. While Udi's hourly rate may not be the cheapest, **the ROI is undoubtedly a deal**. I would highly recommend consulting with Udi.”  
￼[Robert Lewkovich, Product / Development Manager at Eggs Overnight](http://www.linkedin.com/pub/1/3b2/26a)  
“Udi's advice and consulting were a huge time saver for the project I'm responsible for. **The $ spent were well worth it** and provided me with a more complete understanding of nServiceBus and most importantly in helping make the correct architectural decisions earlier thereby reducing later, and more expensive, rework.”  
￼[Ray Houston, Director of Development at TOPAZ Technologies](http://www.linkedin.com/pub/1/469/885)  
“Udi's SOA class made me smart - it was awesome.  
￼The class was very well put together. The materials were clear and concise and Udi did a fantastic job presenting it. It was a good mixture of lecture, coding, and question and answer. I fully expected that I would be taking notes like crazy, but it was so well laid out that the only thing I wrote down the entire course was what I wanted for lunch. Udi provided us with all the lecture materials and everyone has access to all of the samples which are in the nServiceBus trunk.  
￼Now I know why Udi is the "Software Simplist." I was amazed to find that all the code and solutions were indeed very simple. The patterns that Udi presented keep things simple by isolating complexity so that it doesn't creep into your day to day code. The domain code looks the same if it's running in a single process or if it's running in 100 processes.”  
￼[Ian Cooper, Team Lead at Beazley](http://www.linkedin.com/pub/1/469/885)  
“Udi is one of the leaders in the .Net development community, one of the truly smart guys who do not just get best architectural practice well enough to educate others but drives innovation. Udi consistently challenges my thinking in ways that **make me better at what I do**.”  
￼[Liron Levy, Team Leader at Rafael](http://www.linkedin.com/pub/1/578/ab5)  
“I've met Udi when I worked as a team leader in Rafael. One of the most senior managers there knew Udi because he was doing superb architecture job in another Rafael project and he recommended bringing him on board to help the project I was leading.  
Udi brought with him fresh solutions and invaluable deep architecture insights. He is an authority on SOA (service oriented architecture) and this was a tremendous help in our project.  
On the personal level - **Udi is a great communicator and can persuade even the most difficult audiences** (I was part of such an audience myself..) by bringing sound explanations that draw on his extensive knowledge in the software business. Working with Udi was a great learning experience for me, and I'll be happy to work with him again in the future.”  
￼[Adam Dymitruk, Director of IT at Apara Systems](http://www.linkedin.com/in/adymitruk)  
“I met Udi for the first time at DevTeach in Montreal back in early 2007. While Udi is usually involved in SOA subjects, **his knowledge spans all of a software development company's concerns**. I would not hesitate to recommend Udi for any company that needs excellent leadership, mentoring, problem solving, application of patterns, implementation of methodologies and straight out solution development.  
There are very few people in the world that are as dedicated to their craft as Udi is to his. At ALT.NET Seattle, Udi explained many core ideas about SOA. The team that I brought with me found his workshop and other talks the highlight of the event and provided the most value to us and our organization. I am thrilled to have the opportunity to recommend him.”  
￼[Eytan Michaeli, CTO Korentec](http://www.linkedin.com/in/eytanm)  
“Udi was responsible for a major project in the company, and as a chief architect designed a complex multi server C4I system with many innovations and excellent performance.”  
￼￼[Carl Kenne, .Net Consultant at Dotway AB](http://www.linkedin.com/pub/carl-kenne/2/982/aa2)  
“Udi's session "DDD in Enterprise apps" was truly an eye opener. Udi has a great ability to explain complex enterprise designs in a very comprehensive and inspiring way. I've seen several sessions on both DDD and SOA in the past, but Udi puts it in a completly new perspective and **makes us understand what it's all really about**. If you ever have a chance to see any of Udi's sessions in the future, take it!”  
￼[Avi Nehama, R&D Project Manager at Retalix](http://www.linkedin.com/pub/7/b15/407)￼ “Not only that Udi is a briliant software architecture consultant, he also has remarkable abilities to present complex ideas in a simple and concise manner, and...  
always with a smile. Udi is indeed a top-league professional!”  
￼[Ben Scheirman, Lead Developer at CenterPoint Energy](http://www.linkedin.com/in/benscheirman)  
“Udi is one of those rare people who not only deeply understands SOA and domain driven design, but also eloquently conveys that in an easy to grasp way. **He is patient, polite, and easy to talk to**. I'm extremely glad I came to his workshop on SOA.”  
￼[Scott C. Reynolds, Director of Software Engineering at CBLPath](http://www.linkedin.com/in/scottcreynolds) ￼“Udi is consistently advancing the state of thought in software architecture, service orientation, and domain modeling.  
His mastery of the technologies and techniques is second to none, but he pairs that with a singular ability to listen and communicate effectively with all parties, technical and non, to help people **arrive at context-appropriate solutions**. Every time I have worked with Udi, or attended a talk of his, or just had a conversation with him I have come away from it enriched with new understanding about the ideas discussed.”  
￼[Evgeny-Hen Osipow, Head of R&D at PCLine](http://www.linkedin.com/in/obender)￼ “Udi has helped PCLine on projects by implementing architectural blueprints demonstrating the value of simple design and code.”  
￼[Rhys Campbell, Owner at Artemis West](http://www.linkedin.com/in/rhysc)  
“For many years I have been following the works of Udi. His explanation of often complex design and architectural concepts are so cleanly broken down that even the most junior of architects can begin to understand these concepts. These concepts however tend to typify the "real world" problems we face daily so even the most experienced software expert will find himself in an "Aha!" moment when following Udi teachings.  
It was a pleasure to finally meet Udi in Seattle Alt.Net OpenSpaces 2008, where I was pleasantly surprised at **how down-to-earth and approachable** he was. His depth and breadth of software knowledge also became apparent when discussion with his peers quickly dove deep in to the problems we current face. If given the opportunity to work with or recommend Udi I would quickly take that chance. When I think .Net Architecture, I think Udi.”  
￼[Sverre Hundeide, Senior Consultant at Objectware](http://www.linkedin.com/in/rhysc) ￼“Udi had been hired to present the third LEAP master class in Oslo. He is an well known international expert on enterprise software architecture and design, and is the author of the open source messaging framework nServiceBus. The entire class was based on discussion and interaction with the audience, and the only Power Point slide used was the one showing the agenda.  
He started out with sketching a naive traditional n-tier application (big ball of mud), and based on suggestions from the audience we explored different solutions which might improve the solution. Whatever suggestions we threw at him, he always had a thoroughly considered answer describing pros and cons with the suggested solution. **He obviously has a lot of experience with real world enterprise SOA applications**.”  
￼[Raphaël Wouters, Owner/Managing Partner at Medinternals](http://www.linkedin.com/in/raphaelwouters)  
“I attended Udi's excellent course 'Advanced Distributed System Design with SOA and DDD' at Skillsmatter. Few people can truly claim such a high skill and expertise level, present it using a **pragmatic, concrete no-nonsense** approach and still stay reachable.”  
￼[Nimrod Peleg, Lab Engineer at Technion IIT](http://www.linkedin.com/pub/0/674/708)  
“One of the best programmers and software engineer I've ever met, creative, knows how to design and implemet, very collaborative and finally - **the applications he designed implemeted work for many years without any problems!**”  
￼[Jose Manuel Beas](http://www.linkedin.com/in/jmbeas)￼ “When I attended Udi's SOA Workshop, then it suddenly changed my view of what Service Oriented Architectures were all about. Udi explained complex concepts very clearly and created a very productive discussion environment **where all the attendees could learn a lot**. I strongly recommend hiring Udi.”  
￼[Daniel Jin, Senior Lead Developer at PJM Interconnection](http://www.linkedin.com/pub/0/674/708)  
“Udi is one of the top SOA guru in the .NET space. He is always **eager to help others** by sharing his knowledge and experiences. His blog articles often offer deep insights and is a invaluable resource. I highly recommend him.”  
￼[Pasi Taive, Chief Architect at Tieto](http://www.linkedin.com/pub/pasi-taive/0/a93/3b5)  
“I attended both of Udi's "UI Composition Key to SOA Success" and "DDD in Enterprise Apps" sessions and they were exceptionally good. I will definitely participate in his sessions again. **Udi is a great presenter** and has the ability to explain complex issues in a manner that everyone understands.”  
￼[Eran Sagi, Software Architect at HP](http://il.linkedin.com/pub/eran-sagi/0/b55/999)  
“So far, I heard about Service Oriented architecture all over. Everyone mentions it – the big buzz word. But, when I actually asked someone for what does it really mean, no one managed to give me a complete satisfied answer. Finally in his excellent course “Advanced Distributed Systems”, **I got the answers I was looking for**. Udi went over the different motivations (principles) of Services Oriented, explained them well one by one, and showed how each one could be technically addressed using NService bus. In his course, Udi also explain the way of thinking when coming to design a Service Oriented system. What are the questions you need to ask yourself in order to shape your system, place the logic in the right places for best Service Oriented system.  
￼I would recommend this course for any architect or developer who deals with distributed system, but not only. In my work we do not have a real distributed system, but one PC which host both the UI application and the different services inside, all communicating via WCF. I found that many of the architecture principles and motivations of SOA apply for our system as well. Enough that you have SW partitioned into components and most of the principles becomes relevant to you as well. Bottom line – an excellent course recommended to any SW Architect, or any developer dealing with distributed system.”  
￼[Consult with Udi](https://udidahan.com/consulting/)
 
Guest Authored Books

[![Chapter Introduction to SOA](Exported%20image%2020260209135205-16.png)](http://www.jnsk.se/weblog/posts/GuestAuthors.htm)

[![Article The Enterprise Service Bus and Your SOA](Exported%20image%2020260209135207-17.png)](http://www.soa-expertenwissen.de/)
   

[![97 Things Every Software Architect Should Know](Exported%20image%2020260209135212-18.jpeg)](http://www.amazon.com/dp/059652269X)